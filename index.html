<!doctype html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Giuggiolendario</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  /*  1. Sfondo fasce esterne, sfondo campi data, domanda e risposta		
      2. Sfondo fasce intermedie, bordo disclaimer, testi disclaimer, sfondo campo cit		
      3. Sfondo fascia centrale, sfondo disclaimer		
      4. Tutti i testi, tranne il disclaimer
      5. Sfondo pulsante, intestazione
      6. Sfondo del campo data, meglio che sia un colore chiaro sennò non si vede il simbolino
      Err. Messaggio di errore (255,51,51) per il rosso */ 
  
  --colore1:166,16,34;
  --colore2:255,255,255;
  --colore3:166,16,34;
  --colore4:255,215,0;
  --colore5:166,16,34;
  --colore6:255,255,255;
  --coloreErrore: 255,51,51;
  --gradient-angle: 270deg;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:"Inter",system-ui,Segoe UI,Roboto,Arial;color:#fff}
body{
  /* COLORAZIONE DELLO SFONDO */
  background: linear-gradient(var(--gradient-angle), rgb(var(--colore1)) 0%, rgb(var(--colore2)) 25%, rgb(var(--colore3)) 50%,  rgb(var(--colore2)) 75%, rgb(var(--colore1)) 100%);
  display:flex;flex-direction:column;
}
header{
  padding:12px 18px;display:flex;align-items:center;justify-content:space-between;
/* SFONDO DEL RIQUADRO IN ALTO DOVE C'E' IL TITOLO E LA DATA */
  background: rgba(var(--colore5),0.8);backdrop-filter: blur(6px);color:rgb(var(--colore4));
}
.brand{font-weight:700}
.controls{display:flex;gap:12px;align-items:center}
/* RIQUADRO DELLA DATA */ 
input[type="date"]{padding:8px 10px;border-radius:8px;border:0;background:rgba(var(--colore6),0.8);color:rgb(0,0,0)}

/* layout */
main.app{flex:1;display:flex;gap:16px;padding:18px}
.left,.center,.right{
/* RIQUADRI IMMAGINI E CENTRALE */
  background:var(--colore5);border-radius:12px;padding:14px;min-height:320px;
  box-shadow:0 6px 18px rgba(0,0,0,1);
}
.left,.right{width:22%;display:flex;align-items:center;justify-content:center}
.center{flex:1;display:flex;flex-direction:column;align-items:center;gap:12px}

/* RIQUADRO IMMAGINI */   
.img-frame{width:100%;max-width:320px;height:320px;border-radius:10px;overflow:hidden;background:rgba(var(--colore5),0.8);display:flex;align-items:center;justify-content:center}
.img-frame img{width:100%;height:100%;object-fit:cover;display:block}

/* RIQUADRO DELLA DOMANDA */
.question{font-size:1.15rem;font-weight:600;padding:12px;border-radius:8px;background:rgba(var(--colore1),0.8);color:rgb(var(--colore4));min-height:72px;display:flex;align-items:center;justify-content:center;text-align:center}

.answer-area{width:100%;max-width:720px;display:flex;gap:8px;align-items:center}
  
/* RIQUADRO DELLA RISPOSTA  */  
.answer-area input[type="text"]{flex:1;padding:10px;border-radius:8px;border:0;background:rgba(var(--colore1),0.8);color:rgb(var(--colore4))}

/* QUESTO SERVE PER COLORARE IL TESTO INSERISCI TESTO QUI */  
.answer-area input[type="text"]::placeholder {
  color: rgb(var(--colore4));
}
  
/* PULSANTE  */  
.btn{padding:10px 12px;border-radius:8px;border: 2px solid rgb(var(--colore4));cursor:pointer;font-weight:600;background:rgba(var(--colore5),0.8);color:rgb(var(--colore4))}

.feedback{min-height:28px;text-align:center;font-weight:700}

 /* CIT PER RISPOSTA CORRETTA */ 
.phrase{margin-top:6px;padding:8px 10px;border-radius:8px;display:inline-block;font-size: 18px;font-style: italic;font-weight:700; background: rgba(var(--colore2), 0.8);color: rgb(var(--colore4));}

/* modal */
/* SFONODO A TUTTO SCHERMO QUANDO C'E' IL DISCLAIMER */
.modal-backdrop{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:9999;background:rgba(0,0,0,1)}
  
.modal{width:min(720px,94%);border-radius:12px;overflow:hidden;box-shadow:0 18px 60px rgba(0,0,0,1);border: 3px solid rgb(var(--colore2))}
/* PARTE ALTA DEL DISCLAIMER */  
.modal .modal-header{background:rgba(var(--colore3),1);padding:14px 16px;font-weight:700;text-align:center;color:rgb(var(--colore2))}
/* PARTE CENTRALE DEL DISCLAIMER */
.modal .modal-body{padding:18px;background:rgba(var(--colore3),1);color:rgb(var(--colore2))}
/* PARTE INFERIORE DEL DISCLAIMER */
.modal .modal-footer{padding:12px 16px;display:flex;justify-content:flex-end;background:rgba(var(--colore3),1)}
  
@media (max-width:900px){.left,.right{display:none}.center{width:100%}}


</style>
</head>
  
<body>
<header>
  <div class="brand">Il giuggiolendario del mio amore</div>
  <div class="controls">
    <label for="date">Seleziona data</label>
    <input id="date" type="date" />
  </div>
</header>

<main class="app" aria-live="polite">
  <aside class="left">
    <div class="img-frame" id="left-frame">
      <img id="left-img" src="placeholder.jpg" alt="Immagine sinistra" onerror="this.src='placeholder.jpg'">
    </div>
  </aside>

  <section class="center">
    <!-- <-- Qui mostriamo la DOMANDA (entry.question) correttamente -->
    <div class="question" id="question"> </div>

    <div class="answer-area" aria-hidden="false">
      <input id="answer-input" type="text" placeholder="Inserisci la tua risposta..." autocomplete="off" />
      <button id="submit-btn" class="btn">Invia</button>
    </div>

    <div class="feedback" id="feedback" aria-live="polite"></div>
    <div id="phrase" class="phrase" style="display:none"></div>
  </section>

  <aside class="right">
    <div class="img-frame" id="right-frame">
      <img id="right-img" src="placeholder.jpg" alt="Immagine destra" onerror="this.src='placeholder.jpg'">
    </div>
  </aside>
</main>

<!-- Modal disclaimer -->
<div id="modal" class="modal-backdrop" style="display:none" role="dialog" aria-modal="true">
  <div class="modal" role="document">
    <div class="modal-header" id="modal-title">PICDDQTA</div>
    <div class="modal-body" id="modal-body">Caricamento disclaimer...</div>
    <div class="modal-footer">
      <button id="modal-ok" class="btn">OK</button>
    </div>
  </div>
</div>

<script>
(function(){
  const dateInput = document.getElementById('date');
  const questionEl = document.getElementById('question');
  const answerInput = document.getElementById('answer-input');
  const submitBtn = document.getElementById('submit-btn');
  const feedbackEl = document.getElementById('feedback');
  const phraseEl = document.getElementById('phrase');
  const leftImg = document.getElementById('left-img');
  const rightImg = document.getElementById('right-img');
  const modal = document.getElementById('modal');
  const modalBody = document.getElementById('modal-body');
  const modalOk = document.getElementById('modal-ok');
  const modalTitle = document.getElementById('modal-title');

  let Q = {};
  let currentDateStr = null;
  const placeholder = 'placeholder.jpg';

  // range date: inizio anticipato a 2025-12-11 come richiesto
  dateInput.min = '2025-12-11';
  dateInput.max = '2026-12-31';

  // parse 'YYYY-MM-DD' -> Date locale a mezzanotte (evita problemi UTC)
  function parseLocalDateFromYYYYMMDD(ymd){
    if(!ymd) return null;
    const parts = ymd.split('-').map(p => parseInt(p,10));
    if(parts.length !== 3 || parts.some(isNaN)) return null;
    return new Date(parts[0], parts[1]-1, parts[2], 0, 0, 0, 0);
  }

  function todayLocalMidnight(){
    const now = new Date();
    return new Date(now.getFullYear(), now.getMonth(), now.getDate(), 0,0,0,0);
  }

  // imposta valore di default del date picker: oggi se nel range, altrimenti min
  (function setDefaultDate(){
    const today = todayLocalMidnight();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth()+1).padStart(2,'0');
    const dd = String(today.getDate()).padStart(2,'0');
    const todayStr = `${yyyy}-${mm}-${dd}`;
    dateInput.value = (todayStr >= dateInput.min && todayStr <= dateInput.max) ? todayStr : dateInput.min;
  })();

  // carica Q.json (fetch; richiede server HTTP)
  fetch('Q.json').then(r => {
    if (!r.ok) throw new Error('Q.json non trovato');
    return r.json();
  }).then(json => {
    Q = json || {};
    openDisclaimerForSelectedDate(); // mostra disclaimer all'apertura
  }).catch(err => {
    console.warn(err);
    Q = {};
    modalBody.textContent = 'Disclaimer non disponibile (Q.json non trovato).';
    modalTitle.textContent = 'PICDDQTA';
    showModal();
  });

  function showModal(){
    modal.style.display = 'flex';
    answerInput.disabled = true;
    submitBtn.disabled = true;
  }
  function hideModal(){
    modal.style.display = 'none';
    answerInput.disabled = false;
    submitBtn.disabled = false;
    answerInput.focus();
  }

  // controlla se la data selezionata è futura (confronto locale)
  function isFutureDate(ymd){
    const sel = parseLocalDateFromYYYYMMDD(ymd);
    const today = todayLocalMidnight();
    if(!sel) return false;
    return sel.getTime() > today.getTime();
  }

  function setImagesVisible(visible){
    document.querySelector('.left').style.visibility = visible ? 'visible' : 'hidden';
    document.querySelector('.right').style.visibility = visible ? 'visible' : 'hidden';
  }

  // mostra disclaimer al cambio di data o all'apertura
  function openDisclaimerForSelectedDate(){
    feedbackEl.textContent = '';
    phraseEl.style.display = 'none';
    answerInput.value = '';

    const v = dateInput.value;
    currentDateStr = v;

    if (isFutureDate(v)){
      modalTitle.textContent = 'Hey, curiosona ...';
      modalBody.textContent = 'Non spiociare il futuro!!!';
      setImagesVisible(false);
      questionEl.textContent = 'Data futura: nessuna domanda mostrata';
      showModal();
      return;
    }

    const entry = Q[v];
    modalTitle.textContent = 'PICDDQTA';
    modalBody.textContent = entry && entry.disclaimer ? entry.disclaimer : 'Attenzione: disclaimer non trovato per questa data.';
    showModal();
  }

  // carica contenuti (domanda e immagini) dopo chiusura disclaimer
  function loadContentForDate(v){
    if(isFutureDate(v)){
      setImagesVisible(false);
      document.querySelector('.right').style.visibility = 'hidden';
      questionEl.textContent = 'Data futura: nessuna domanda mostrata';
      feedbackEl.textContent = '';
      phraseEl.style.display = 'none';
      return;
    }

    const entry = Q[v];
    if(!entry){
      questionEl.textContent = 'Nessuna domanda disponibile per questa data.';
      setImagesVisible(false);
      feedbackEl.textContent = '';
      phraseEl.style.display = 'none';
      return;
    }

    // -------------------------
    // CORREZIONE PRINCIPALE: MOSTRIAMO LA DOMANDA
    // -------------------------
    // Prima veniva mostrato entry.answer; ora mostriamo entry.question.
    questionEl.textContent = entry.question || '---';

    // immagini: left sempre visibile (o placeholder), right nascosta finché non c'è risposta corretta
    leftImg.src = `Sx/${v}.jpg`;
    leftImg.onerror = function(){ this.onerror=null; this.src = placeholder; };

    rightImg.src = `Dx/${v}.jpg`;
    rightImg.onerror = function(){ this.onerror=null; this.src = placeholder; };

    document.querySelector('.left').style.visibility = 'visible';
    document.querySelector('.right').style.visibility = 'hidden';

    feedbackEl.textContent = '';
    phraseEl.style.display = 'none';
  }

  // eventi
  dateInput.addEventListener('change', () => {
    openDisclaimerForSelectedDate();
  });

  modalOk.addEventListener('click', () => {
    const v = dateInput.value;
    hideModal();
    if (isFutureDate(v)){
      setImagesVisible(false);
      document.querySelector('.right').style.visibility = 'hidden';
      questionEl.textContent = 'Data futura: nessuna domanda mostrata';
      feedbackEl.textContent = '';
      phraseEl.style.display = 'none';
      return;
    }
    loadContentForDate(v);
  });

  submitBtn.addEventListener('click', checkAnswer);
  answerInput.addEventListener('keydown', (e) => { if(e.key === 'Enter') checkAnswer(); });

  // verifica risposta usando entry.answer (confronto case-insensitive)
  function checkAnswer(){
    const v = dateInput.value;
    if (isFutureDate(v)){
      feedbackEl.innerHTML = '<span style="color:rgb(var(--coloreErrore))">Ops... Risposta sbagliata!!!</span>';
      phraseEl.style.display = 'none';
      return;
    }

    const entry = Q[v];
    if (!entry){
      feedbackEl.innerHTML = '<span style="color:#ff3333">Ops... Risposta sbagliata!!!</span>';
      phraseEl.style.display = 'none';
      return;
    }

    const userAns = (answerInput.value || '').trim();
    const correctAns = (entry.answer || '').trim();

    const ok = userAns.toLowerCase() === correctAns.toLowerCase();

    if (ok){
      // risposta esatta -> mostro phrase (verde) e immagine destra
      feedbackEl.textContent = '';
      phraseEl.textContent = entry.phrase || '';
      phraseEl.style.display = 'inline-block';
      document.querySelector('.right').style.visibility = 'visible';
      document.querySelector('.left').style.visibility = 'visible';
    } else {
      // risposta sbagliata -> solo messaggio rosso, nessuna citazione
      feedbackEl.innerHTML = '<span style="color:#ff3333">Ops... Risposta sbagliata!!!</span>';
      phraseEl.textContent = '';
      phraseEl.style.display = 'none';
      document.querySelector('.right').style.visibility = 'hidden';
    }
  }

})();
</script>
</body>
</html>







































































